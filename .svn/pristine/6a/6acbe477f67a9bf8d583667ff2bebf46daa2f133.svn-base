webpackJsonp([1],{UJQy:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t("sRoY"),r=t.n(l),s=t("8+FI"),o=t("I2ex"),n=null,i={name:"baseform",data:function(){return{options:[{value:"guangdong",label:"广东省",children:[{value:"guangzhou",label:"广州市",children:[{value:"tianhe",label:"天河区"},{value:"haizhu",label:"海珠区"}]},{value:"dongguan",label:"东莞市",children:[{value:"changan",label:"长安镇"},{value:"humen",label:"虎门镇"}]}]},{value:"hunan",label:"湖南省",children:[{value:"changsha",label:"长沙市",children:[{value:"yuelu",label:"岳麓区"}]}]}],houseId:0,furnitureArray:[],form:{introduce:"",price:"",deposit:"",payment:"",water_price:"",electricity_price:"",contacts:"",tel:"",address:"",longitude:"",latitude:"",house_furniture:[],rooms:"",halls:"",toilet:"",acreage:"",orientation:"",house_floor:"",building_floor:"",pet:1,parking_space:"",pic_id:0,picUrl:"",house_banner:[],furnitureLis:[]},imageUrl:"",bannerUrl:""}},components:{VueCropper:r.a},created:function(){n=this;var e=this.$route.params.id;e&&(this.houseId=e)},beforeRouteUpdate:function(e,a,t){t()},mounted:function(){this.detailForEdit()},methods:{onSubmit:function(){this.form.furniture=this.furnitureArray;var e={house:this.form,houseBanner:this.form.house_banner},a=this.showLoading();this.houseId?o.a.editHouse({param:e,success:function(e){a.close(),0===e.code?n.$alert("修改成功","提示",{confirmButtonText:"确定",callback:function(e){n.closeCurrTag()}}):n.$message.error(e.msg)},fail:function(e){a.close()}}):o.a.createHouse({param:e,success:function(e){a.close(),0===e.code?n.$alert("添加成功","提示",{confirmButtonText:"确定",callback:function(e){n.closeCurrTag()}}):n.$message.error(e.msg)},fail:function(e){a.close()}})},addBannerItem:function(e){this.form.house_banner[e].items.unshift({imgUrl:"",img_id:"",weight:0})},delBannerItem:function(e,a){this.form.house_banner[e].items.splice(a,1)},addBanner:function(){this.form.house_banner.unshift({name:"",weight:"",panorama_id:"",panoramaUrl:"",items:[]})},delBanner:function(e){this.form.house_banner.splice(e,1)},handlePicsSuccess:function(e,a){0===e.code?(this.$set(n.form,"picUrl",e.data.url),this.$set(n.form,"pic_id",e.data.id)):n.$message.error(e.msg)},beforePicsUpload:function(e){var a="image/jpeg"===e.type,t="image/png"===e.type,l=a||t,r=e.size/1024/1024<2;return l||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),l&&r},handlePanoramaSuccess:function(e,a){if(0===e.code){var t=e.data;n.form.house_banner[t.arrIndex].panoramaUrl=t.url,n.form.house_banner[t.arrIndex].panorama_id=t.id}else n.$message.error(e.msg)},beforePanoramaUpload:function(e){var a="image/jpeg"===e.type,t="image/png"===e.type,l=a||t,r=e.size/1024/1024<2;return l||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),l&&r},handleBannerSuccess:function(e,a){if(0===e.code){var t=e.data;n.form.house_banner[t.arrIndex].items[t.itemIndex].imgUrl=t.url,n.form.house_banner[t.arrIndex].items[t.itemIndex].img_id=t.id,n.form.house_banner[t.arrIndex].items[t.itemIndex].weight=0}else n.$message.error(e.msg)},beforeBannerUpload:function(e){var a="image/jpeg"===e.type,t="image/png"===e.type,l=a||t,r=e.size/1024/1024<2;return l||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),l&&r},handleRemove:function(e,a){},detailForEdit:function(){var e={id:this.houseId},a=this.showLoading();o.a.detailForEdit({param:e,success:function(e){a.close(),0==e.code?(e.data.id?n.form=e.data:n.$set(n.form,"furnitureLis",e.data.furnitureLis),n.form.pet=1):n.$message.error(e.msg)},fail:function(){a.close()}})},closeCurrTag:function(){s.a.$emit("closeTag",this.$route.path)},showLoading:function(){return this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})}}},c={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"crumbs"},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[t("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 房东宣传页管理")]),e._v(" "),t("el-breadcrumb-item",[e._v("添加宣传页")])],1)],1),e._v(" "),t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"介绍"}},[t("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.form.introduce,callback:function(a){e.$set(e.form,"introduce",a)},expression:"form.introduce"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"价格"}},[t("el-input",{model:{value:e.form.price,callback:function(a){e.$set(e.form,"price",a)},expression:"form.price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"押金"}},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("押")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.deposit,callback:function(a){e.$set(e.form,"deposit",a)},expression:"form.deposit"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("付")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.payment,callback:function(a){e.$set(e.form,"payment",a)},expression:"form.payment"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"水费"}},[t("el-input",{model:{value:e.form.water_price,callback:function(a){e.$set(e.form,"water_price",a)},expression:"form.water_price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电费"}},[t("el-input",{model:{value:e.form.electricity_price,callback:function(a){e.$set(e.form,"electricity_price",a)},expression:"form.electricity_price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系人"}},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("姓名")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.contacts,callback:function(a){e.$set(e.form,"contacts",a)},expression:"form.contacts"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("电话")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.tel,callback:function(a){e.$set(e.form,"tel",a)},expression:"form.tel"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"地址"}},[t("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.form.address,callback:function(a){e.$set(e.form,"address",a)},expression:"form.address"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"坐标"}},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("经度")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.longitude,callback:function(a){e.$set(e.form,"longitude",a)},expression:"form.longitude"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("纬度")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.latitude,callback:function(a){e.$set(e.form,"latitude",a)},expression:"form.latitude"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"配置"}},[t("el-checkbox-group",{model:{value:e.furnitureArray,callback:function(a){e.furnitureArray=a},expression:"furnitureArray"}},e._l(e.form.furnitureLis,function(a,l){return t("el-checkbox",{key:l,attrs:{border:"",label:a.id,checked:a.isSelect}},[e._v(e._s(a.name)+"\n                        ")])}))],1),e._v(" "),t("el-form-item",{attrs:{label:"户型"}},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("室")]),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-input",{model:{value:e.form.rooms,callback:function(a){e.$set(e.form,"rooms",a)},expression:"form.rooms"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("厅")]),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-input",{model:{value:e.form.halls,callback:function(a){e.$set(e.form,"halls",a)},expression:"form.halls"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("卫")]),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-input",{model:{value:e.form.toilet,callback:function(a){e.$set(e.form,"toilet",a)},expression:"form.toilet"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"面积"}},[t("el-input",{model:{value:e.form.acreage,callback:function(a){e.$set(e.form,"acreage",a)},expression:"form.acreage"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"朝向"}},[t("el-radio-group",{model:{value:e.form.orientation,callback:function(a){e.$set(e.form,"orientation",a)},expression:"form.orientation"}},[t("el-radio",{attrs:{label:"东"}}),e._v(" "),t("el-radio",{attrs:{label:"南"}}),e._v(" "),t("el-radio",{attrs:{label:"西"}}),e._v(" "),t("el-radio",{attrs:{label:"北"}}),e._v(" "),t("el-radio",{attrs:{label:"南北"}}),e._v(" "),t("el-radio",{attrs:{label:"东西"}}),e._v(" "),t("el-radio",{attrs:{label:"东南"}}),e._v(" "),t("el-radio",{attrs:{label:"西南"}}),e._v(" "),t("el-radio",{attrs:{label:"东北"}}),e._v(" "),t("el-radio",{attrs:{label:"西北"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"楼层"}},[t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.house_floor,callback:function(a){e.$set(e.form,"house_floor",a)},expression:"form.house_floor"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("楼 ，共")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:e.form.building_floor,callback:function(a){e.$set(e.form,"building_floor",a)},expression:"form.building_floor"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("层")])],1),e._v(" "),t("el-form-item",{attrs:{label:"饲养宠物"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.pet,callback:function(a){e.$set(e.form,"pet",a)},expression:"form.pet"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"停车位"}},[t("el-input",{model:{value:e.form.parking_space,callback:function(a){e.$set(e.form,"parking_space",a)},expression:"form.parking_space"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"首图"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/house/upload","show-file-list":!1,"on-success":e.handlePicsSuccess,"before-upload":e.beforePicsUpload}},[e.form.picUrl?t("img",{staticClass:"avatar",attrs:{src:e.form.picUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"图片模块"}},[t("div",{staticClass:"toolBar"},[t("el-row",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addBanner}},[e._v("添加")])],1)],1),e._v(" "),e._l(e.form.house_banner,function(a,l){return t("div",{staticClass:"bannerBox"},[t("el-row",{staticClass:"bannerItemToolBar"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:function(a){e.delBanner(l)}}},[e._v("删除\n                            ")])],1),e._v(" "),t("el-row",{staticClass:"bannerItem"},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("名称")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:a.name,callback:function(t){e.$set(a,"name",t)},expression:"banner.name"}})],1)],1),e._v(" "),t("el-row",{staticClass:"bannerItem"},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("权重")]),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{model:{value:a.weight,callback:function(t){e.$set(a,"weight",t)},expression:"banner.weight"}})],1)],1),e._v(" "),t("el-row",{staticClass:"bannerItem"},[t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("全景图")]),e._v(" "),t("el-col",{attrs:{span:20}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/house/upload",data:{arrIndex:l},"show-file-list":!1,"on-success":e.handlePanoramaSuccess,"before-upload":e.beforePanoramaUpload}},[a.panoramaUrl?t("img",{staticClass:"avatar",attrs:{src:a.panoramaUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),t("el-row",{staticClass:"bannerItem"},[t("el-col",{staticClass:"line",attrs:{span:2}},[t("div",{},[e._v("轮播图")]),e._v(" "),t("div",{},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(a){e.addBannerItem(l)}}})],1)]),e._v(" "),t("el-col",{attrs:{span:22}},e._l(a.items,function(a,r){return t("div",{key:r,staticClass:"bannerItemBox"},[t("el-upload",{staticClass:"bannerItem-uploader",attrs:{action:"/api/house/upload",data:{arrIndex:l,itemIndex:r},"show-file-list":!1,"on-success":e.handleBannerSuccess,"before-upload":e.beforeBannerUpload}},[a.imgUrl?t("img",{staticClass:"bannerItemImg",attrs:{src:a.imgUrl}}):t("i",{staticClass:"el-icon-plus bannerItem-uploader-icon"})]),e._v(" "),t("el-row",{staticClass:"itemBar"},[t("el-col",{staticClass:"line",attrs:{span:12}},[t("el-input",{staticClass:"itemWeight",model:{value:a.weight,callback:function(t){e.$set(a,"weight",t)},expression:"item.weight"}})],1),e._v(" "),t("el-col",{staticClass:"line",attrs:{span:6}},[t("el-button",{attrs:{icon:"el-icon-delete",circle:""},on:{click:function(a){e.delBannerItem(l,r)}}})],1)],1)],1)}))],1)],1)})],2),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),t("el-button",[e._v("取消")])],1)],1)],1)])])},staticRenderFns:[]};var u=t("VU/8")(i,c,!1,function(e){t("hqKq")},"data-v-857a83f2",null);a.default=u.exports},hqKq:function(e,a){}});