<template>
    <div>
        <div class="crumbs">
            <el-breadcrumb separator="/">
                <el-breadcrumb-item><i class="el-icon-lx-calendar"></i> 房东宣传页管理</el-breadcrumb-item>
                <el-breadcrumb-item>添加宣传页</el-breadcrumb-item>
            </el-breadcrumb>
        </div>
        <div class="container">
            <div class="form-box">
                <el-form ref="form" :model="form" label-width="80px">
                    <el-form-item label="房东姓名">
                        <el-input v-model="form.name"></el-input>
                    </el-form-item>
                    <el-form-item label="房东电话">
                        <el-input v-model="form.tel"></el-input>
                    </el-form-item>

                    <el-form-item label="介绍">
                        <el-input type="textarea" rows="5" v-model="form.introduce"></el-input>
                    </el-form-item>
                    <el-form-item label="头像">
                        <el-upload
                                class="avatar-uploader"
                                action="/api/house/upload"
                                :show-file-list="false"
                                :on-success="handleAvatarSuccess"
                                :before-upload="beforeAvatarUpload">
                            <img v-if="imageUrl" :src="imageUrl" class="avatar">
                            <i v-else class="el-icon-plus avatar-uploader-icon"></i>
                        </el-upload>
                    </el-form-item>
                    <el-form-item label="海报">
                        <el-upload
                                class="banner-uploader"
                                action="/api/house/upload"
                                :show-file-list="false"
                                :on-success="handleBannerSuccess"
                                :before-upload="beforeBannerUpload">
                            <img v-if="bannerUrl" :src="bannerUrl" class="banner">
                            <i v-else class="el-icon-plus banner-uploader-icon"></i>
                        </el-upload>
                    </el-form-item>

                    <el-form-item>
                        <el-button type="primary" @click="onSubmit">提交</el-button>
                        <el-button>取消</el-button>
                    </el-form-item>
                </el-form>
            </div>
        </div>


    </div>
</template>

<script type="text/ecmascript-6">
import VueCropper  from 'vue-cropperjs';
export default {
    name: 'baseform',
    data: function () {
        return {
            options: [
                {
                    value: 'guangdong',
                    label: '广东省',
                    children: [
                        {
                            value: 'guangzhou',
                            label: '广州市',
                            children: [
                                {
                                    value: 'tianhe',
                                    label: '天河区'
                                },
                                {
                                    value: 'haizhu',
                                    label: '海珠区'
                                }
                            ]
                        },
                        {
                            value: 'dongguan',
                            label: '东莞市',
                            children: [
                                {
                                    value: 'changan',
                                    label: '长安镇'
                                },
                                {
                                    value: 'humen',
                                    label: '虎门镇'
                                }
                            ]
                        }
                    ]
                },
                {
                    value: 'hunan',
                    label: '湖南省',
                    children: [
                        {
                            value: 'changsha',
                            label: '长沙市',
                            children: [
                                {
                                    value: 'yuelu',
                                    label: '岳麓区'
                                }
                            ]
                        }
                    ]
                }
            ],
            form: {
                name: '',
                region: '',
                date1: '',
                date2: '',
                delivery: true,
                type: ['步步高'],
                resource: '小天才',
                desc: '',
                options: []
            },
            imageUrl: '',
            bannerUrl: ''
        }
    },
    components: {
        VueCropper
    },
    methods: {
        onSubmit() {
            this.$message.success('提交成功！');
        },
        handleAvatarSuccess(res, file) {
            this.imageUrl = URL.createObjectURL(file.raw);
        },
        beforeAvatarUpload(file) {
            console.log(file);
            const isJPG = file.type === 'image/jpeg';
            const isPNG = file.type === 'image/png';

            const isImageType = (isJPG || isPNG);
            const isLt2M = file.size / 1024 / 1024 < 2;

            if (!isImageType) {
                this.$message.error('上传头像图片只能是 JPG或者PNG 格式!');
            }
            if (!isLt2M) {
                this.$message.error('上传头像图片大小不能超过 2MB!');
            }
            return isImageType && isLt2M;
        },
        handleBannerSuccess(res, file) {
            console.log(res)
            this.bannerUrl = URL.createObjectURL(file.raw);
        },
        beforeBannerUpload(file) {
            debugger
            const isJPG = file.type === 'image/jpeg';
            const isPNG = file.type === 'image/png';
            const isImageType = (isJPG || isPNG);
            const isLt2M = file.size / 1024 / 1024 < 2;

            if (!isImageType) {
                this.$message.error('上传头像图片只能是 JPG或者PNG 格式!');
            }
            if (!isLt2M) {
                this.$message.error('上传头像图片大小不能超过 2MB!');
            }
            return isImageType && isLt2M;
        }
    }
}
</script>

<style lang="less" scoped>

  /deep/ .avatar-uploader{
      .el-upload {
          border: 1px dashed #d9d9d9;
          border-radius: 6px;
          cursor: pointer;
          position: relative;
          overflow: hidden;
          width: 178px;
          height: 178px;
          &:hover {
              border-color: #409EFF;
          }
      }
      .avatar-uploader-icon {
          font-size: 28px;
          color: #8c939d;
          width: 178px;
          height: 178px;
          line-height: 178px;
          text-align: center;
      }
      .avatar {
          width: 178px;
          height: 178px;
          display: block;
      }
  }

  /deep/ .banner-uploader {
      width:375px;
      height:313px;
      .el-upload {
          border: 1px dashed #d9d9d9;
          border-radius: 6px;
          cursor: pointer;
          position: relative;
          overflow: hidden;
          width:375px;
          height:313px;
          &:hover {
              border-color: #409EFF;
          }
      }
      .banner-uploader-icon {
          font-size: 28px;
          color: #8c939d;
          width: 178px;
          height: 178px;
          line-height: 313px;
          text-align: center;
      }
      .banner {
          width:375px;
          height:313px;
          display: block;
      }
  }
</style>